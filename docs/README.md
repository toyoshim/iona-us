---
layout: default
title: 取扱説明書
permalink: /
---
# 取扱説明書
---

## 概要
JVS仕様の基板にUSBコントローラを接続するための変換基板です。
電源や映像・音声が標準規格を用いているexA-Arcadiaのような基板では、コントローラ入出力のみが特殊なI/Oとなっていますが、この変換基板を使うことでコントローラにも汎用品を用いる事ができるようになります。

## 互換性
### JVSシステム
[MP01-IONA-JS](../iona-js/)と同様に、現存するほぼ全てのJVSシステムに対応しています。また、現状ではnaomiの電脳戦機バーチャロン オラトリオ・タングラムの特殊レイアウトやスーチーパイIII等の麻雀レイアウトにも対応しています。詳細は後述のツインスティックモード、麻雀モードの説明を御覧ください。

### USBコントローラ
Xbox 360、Xbox Oneシリーズ、PlayStation 4のほぼ全てのコントローラに対応していると思われます。またPlayStation 3やSwitchのコントローラでも確認できる範囲では対応しました。
USBコントローラの多くは個別の対応が必要なため、全てのコントローラをサポートしているわけではありませんが、可能な限り柔軟に対応するようファームウェアを作ってあります。コントローラの持つボタンの数にもよりますが、最大で1レバー10ボタンまで対応。レバーに関しては左アナログスティックと十字ボタン両方に対応しています。

もし未対応のコントローラがあった場合には、[報告](report)ページから連絡を頂ければ可能な限り対応したいと思います。

## 接続方法
![基板説明図](pcb_photo.jpg)
①電源用micro USB端子からIONA-US用の電源をとります。データ通信は不要ですので充電専用のアダプタに接続しても構いませんし、他のホスト機のUSB端子からバス電力を供給してもらっても動作します。

②JVS端子をJVSシステムの基板と接続します。一般的なタイプAオス-タイプBオスのUSBケーブルが利用できます。

③④にはUSBコントローラを接続できます。動作中でも随時抜き差しが可能です。

電源投入時にはLEDが高速点滅し、JVSバスからアドレスを設定され通信可能となったタイミングで点灯に変化します。JVSバスからリセット信号を受けた際には再度高速点滅を始めます。

## 機能
### ボタンレイアウト
10個までの物理ボタンをJVS上の任意のボタンに再配置できます。1つの物理ボタンを複数ボタンにアサインする事や、複数の物理ボタンを1つのボタンにアサインする事もできますので、同時押しボタンや連射専用ボタンなどが設定できます。

### 連射
物理ボタンごとに連射の設定ができます。速度は30/20/15/12/10/8.5から選択できます。JVSの仕様上、映像同期信号に合わせたシンクロ連射にはなりませんが、JVSバスと同期することでゲームの処理と同期したシンクロ連射が実現されています。

### 設定保存
最大10個までのレイアウト・連射設定を保存・呼び出しできます。電源投入時には最後に利用していた設定が呼び出されます。

### ファームウェア更新
バグ修正や互換性改善などの提供のためのファームウェア更新が利用可能です。特殊な装置を必要とせず、PCとUSB接続の上、Chromeから更新できます。

### ツインスティックモード
1P側のUSB端子にPS4系のコントローラを接続している場合、PSボタンを押すごとに通常モードとツインスティックモードが切り替わります。
ツインスティックモードでは、左アナログスティックとL1-3が1P側のコントローラに、右アナログとR1-3が2P側のコントローラにアサインされます。またボタン1が2P側のスタートボタンとして機能します。
このモードの配置は、タニタ製ツインスティックやPS4の2つのアナログスティックを使って電脳戦機バーチャロン オラトリオ・タングラムを遊ぶために調整されていますが、3ボタンまでのゲームを片手で遊んだり、一人で二人分の操作を行うダブルプレイを楽しむためにも使えます。

### 麻雀モード
Bootモード対応のキーボード（市販のキーボードはほぼ間違いなく対応していると思います）を接続すると、麻雀モードに切り替わります。
このモードではNAOMIの麻雀ゲームが想定するプロトコルに対応します。配列は一般的なものを採用し、A-Nはそのままアルファベットに対応、コインが5、スタートが1、カン・ポン・チー・リーチがそれぞれCTRL、ALT、SPACE、SHIFTに対応し、ロンがアルファベットのZに対応します。

## 各種設定
### 設定モードの遷移
![動作モード遷移](mode_fsm.svg)
IONA-USは起動後に通常モードに入った後、基板上のTESTボタン、SERVICEボタンの組み合わせで、上記のように動作モードが遷移します。

### ①通常モード(LED - JVSバスの状態により点滅または点灯)
選択された設定でJVSバスに繋がったコントローラとして動作します。

### ②ボタンレイアウトモード（LED - 高速点滅）
TESTとSERVICEボタンを同時押しする事で、設定モードに入ります。
同時押しは、両方のボタンが同時にONとなるタイミングがあれば、同時でなくとも（例えばTESTを押しっぱなしにしながらSERVICEを押すなどでも）大丈夫です。

ボタンレイアウトモードでは、コイン、スタート、ボタン１〜１０の順で、これらのボタンに対応する物理ボタンを選択していきます。同時押しする事で、複数の物理ボタンを１つのボタンにアサイン可能です。ここでも同時押しは、押すタイミング、離すタイミングがずれていても問題ありません。一度ボタンが押されたら、全てのボタンが離されたタイミングでそのボタンの設定が確定し、次のボタン設定入力に備えます。１２個のボタン全てについて順次設定してください。途中でこのモードを抜けた場合、それ以降のボタンについては物理ボタンがアサインされません。例外として、１つもボタンを設定しなかった場合は、設定を変更せずに次のモードに移行します。

### ③連射ボタン設定モード（LED - 点滅）
連射をオンにしたい物理ボタンを同時押しします。同時押しの概念については同様で、全てのボタンが離されたタイミングで設定が保存されます。次のモードに遷移するまで何度でも再設定できます。

### ④連射速度設定モード（LED - 低速点滅）
連射速度をボタン１〜６で選択します。ここでのボタンは物理ボタンではなく、レイアウト設定に従った、JVS上でのボタン番号です。ボタン1から順に連射速度30/20/15/12/10/8.5に対応します。何度でも選択可能です。同時押しは意味がありませんので、仮に同時に押された場合には速度の速い方が選択されます。離すタイミングが異なった場合、最後に離した方が選択されます。

以上の設定は、現在選択中の設定に対して恒久的に変更がなされます。

### ⑤設定初期化（LED - 瞬間的に点滅）
設定モードのいずれかにいる際に、もう一度TESTとSERVICEを同時押しする事で、Flashに保存された全てのレイアウト・連射設定を初期化し、出荷時の状態に戻します。
初期化後は自動的に通常モードに戻ります。

### ⑥設定呼び出しモード(LED - 消灯)
設定モードのいずれかにいる際に、SERVICEボタンを押す事で設定呼び出しモードに入ります。
ボタン１〜１０を押す事で、各ボタンに対応する設定が呼び出されます。初期状態ではボタン１の設定が利用されています。またボタンは物理ボタンではなく、レイアウト設定されたJVS上でのボタン番号です。
再びSERVICEボタンを押すまで何度も選択できます。
SERVICEボタンで通常モードに戻ります。

### 設定のポイント
レイアウトと連射をうまく設定する事で、３ボタン用のゲームを通常の３ボタン＋連射対応の３ボタンの計６ボタンに配置する事もできます。この場合では、レイアウト設定でコイン、スタート、ボタン1+4、ボタン2+5、ボタン3+6、……と設定し、連射でボタン4+5+6を設定します。
あるいは、レイアウト設定で、コイン、スタート、ボタン1+4、ボタン2+4、ボタン3+4、……と設定すれば、ボタン4がボタン1+2+3の同時押しボタンとして機能します。

## バージョンについて
### 基板のバージョン
- Ver 1.10のみが出荷されています。

### ファームウェアのバージョン
- 現在流通している版ではVer 1.20が初期状態で書き込まれています。
- ファームウェアは[ファームウェア](firmware)ページから任意のバージョンに更新可能です。

## 問い合わせ
質問は[Twitter](https://twitter.com/toyoshim)等で声をかけて頂ければできる限りお答えします。
相性問題の報告やUSBコントローラの対応要望、機能追加のアイデアどもあればぜひご連絡ください。
