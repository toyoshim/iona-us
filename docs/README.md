# MP07-IONA-US サポートページ

![QRコード](qrcode.png)

## 概要
JVS仕様の基板にUSBコントローラを接続するための変換基板です。
電源や映像・音声が標準規格を用いているexA-Arcadiaのような基板では、コントローラ入出力のみが特殊なI/Oとなっていますが、この変換基板を使うことでコントローラにも汎用品を用いる事ができるようになります。

## 互換性
### JVSシステム
[MP01-IONA-JS](../iona-js/)と同様に、現存するほぼ全てのJVSシステムに対応しています。

### USBコントローラ
Xbox 360、Xbox Oneシリーズ、PlayStation 4のほぼ全てのコントローラに対応していると思われます。またPlayStation 3やSwitchのコントローラでも確認できる範囲では対応しました。
USBコントローラの多くは個別の対応が必要なため、全てのコントローラをサポートしているわけではありませんが、可能な限り柔軟に対応するようファームウェアを作ってあります。コントローラの持つボタンの数にもよりますが、最大で1レバー10ボタンまで対応。レバーに関しては左アナログスティックと十字ボタン両方に対応しています。

もし未対応のコントローラがあった場合には、連絡を頂ければ可能な限り対応したいと思います。その際、USBコントローラの持つデスクリプタの内容を提供して頂くことになるかと思います。必要な情報の抽出はChrome上で行えるようにする予定です。ファームウェアの更新もChrome上で提供予定です。

## 接続方法
![基板説明図](pcb_photo.jpg)
①電源用micro USB端子からIONA-US用の電源をとります。データ通信は不要ですので充電専用のアダプタに接続しても構いませんし、他のホスト機のUSB端子からバス電力を供給してもらっても動作します。

②JVS端子をJVSシステムの基板と接続します。一般的なタイプAオス-タイプBオスのUSBケーブルが利用できます。

③④にはUSBコントローラを接続できます。動作中でも随時抜き差しが可能です。

電源投入時にはLEDが高速点滅し、JVSバスからアドレスを設定され通信可能となったタイミングで点灯に変化します。JVSバスからリセット信号を受けた際には再度高速点滅を始めます。

## 機能
### ボタンレイアウト
10個までの物理ボタンをJVS上の任意のボタンに再配置できます。1つの物理ボタンを複数ボタンにアサインする事や、複数の物理ボタンを1つのボタンにアサインする事もできますので、同時押しボタンや連射専用ボタンなどが設定できます。

### 連射
物理ボタンごとに連射の設定ができます。速度は30/20/15/12/10/8.5から選択できます。JVSの仕様上、映像同期信号に合わせたシンクロ連射にはなりませんが、JVSバスと同期することでゲームの処理と同期したシンクロ連射が実現されています。

### 設定保存
最大10個までのレイアウト・連射設定を保存・呼び出しできます。電源投入時には最後に利用していた設定が呼び出されます。

### ファームウェア更新
バグ修正や互換性改善などの提供のため、ファームウェア更新が利用可能となる予定です。特殊な装置を必要とせず、PCとUSB接続の上、Chromeから更新できるようにする予定です。

## 各種設定
### 設定モードの遷移
![動作モード遷移](mode_fsm.svg)
IONA-USは起動後に通常モードに入った後、基板上のTESTボタン、SERVICEボタンの組み合わせで、上記のように動作モードが遷移します。

### ①通常モード(LED - JVSバスの状態により点滅または点灯)

### ②ボタンレイアウトモード（LED - 高速点滅）

### ③連射ボタン設定モード（LED - 点滅）

### ④連射速度設定モード（LED - 低速点滅）

### ⑤設定初期化（LED - 瞬間的に点滅）

### ⑥設定呼び出しモード(LED - 消灯)
